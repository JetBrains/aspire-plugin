<idea-plugin>
    <dependencies>
        <module name="intellij.aspire.core"/>
        <plugin id="com.intellij.modules.rider"/>
    </dependencies>

    <resource-bundle>messages.AspireRiderBundle</resource-bundle>

    <extensionPoints>
        <extensionPoint qualifiedName="com.jetbrains.aspire.dotnetSessionProcessLauncherExtension"
                        interface="com.jetbrains.aspire.rider.sessions.DotNetSessionProcessLauncherExtension"
                        dynamic="true"/>
        <extensionPoint qualifiedName="com.jetbrains.aspire.projectOrchestrationHandler"
                        interface="com.jetbrains.aspire.rider.orchestration.AspireProjectOrchestrationHandler"
                        dynamic="true"/>
    </extensionPoints>

    <projectListeners>
        <listener class="com.jetbrains.aspire.rider.run.AspireRunConfigurationListener"
                  topic="com.intellij.execution.RunManagerListener"/>
        <listener class="com.jetbrains.aspire.rider.run.AspireExecutionListener"
                  topic="com.intellij.execution.ExecutionListener"/>
        <listener class="com.jetbrains.aspire.rider.sessions.SessionProfileModeService$Listener"
                  topic="com.intellij.execution.ExecutionListener"/>
    </projectListeners>

    <extensions defaultExtensionNs="com.intellij">
        <configurationType implementation="com.jetbrains.aspire.rider.run.AspireConfigurationType"/>
        <runConfigurationProducer
                implementation="com.jetbrains.aspire.rider.run.host.AspireHostRunConfigurationProducer"/>

        <programRunner implementation="com.jetbrains.aspire.rider.run.runners.AspireHostProgramRunner"/>
        <programRunner implementation="com.jetbrains.aspire.rider.run.runners.AspireHostDebugProgramRunner"/>

        <programRunner
                implementation="com.jetbrains.aspire.rider.sessions.projectLaunchers.DotNetSessionProgramRunner"/>
        <programRunner
                implementation="com.jetbrains.aspire.rider.sessions.projectLaunchers.DotNetSessionDebugProgramRunner"/>
        <programRunner
                implementation="com.jetbrains.aspire.rider.sessions.wasmHost.WasmHostProjectSessionDebugProgramRunner"/>

        <rd.solutionExtListener endpoint="IDE Frontend"
                                listener="com.jetbrains.aspire.rider.unitTests.AspireUnitTestProtocolListener"/>
    </extensions>

    <extensions defaultExtensionNs="com.jetbrains.aspire">
        <appHostLauncher implementation="com.jetbrains.aspire.rider.run.RunConfigurationBasedAppHostLauncher"/>

        <startSessionRequestHandler
                implementation="com.jetbrains.aspire.rider.sessions.DotNetStartSessionRequestHandler"/>

        <dotnetSessionProcessLauncherExtension
                implementation="com.jetbrains.aspire.rider.sessions.wasmHost.WasmHostProjectSessionProcessLauncher"/>
        <dotnetSessionProcessLauncherExtension
                implementation="com.jetbrains.aspire.rider.sessions.dotnetProject.DotNetProjectSessionProcessLauncher"/>
        <dotnetSessionProcessLauncherExtension
                implementation="com.jetbrains.aspire.rider.sessions.executableLibrary.ExecutableLibrarySessionProcessLauncher"/>

        <projectOrchestrationHandler implementation="com.jetbrains.aspire.rider.orchestration.DefaultProjectOrchestrationHandler"/>
        <projectOrchestrationHandler implementation="com.jetbrains.aspire.rider.orchestration.MauiProjectOrchestrationHandler"/>
        <projectOrchestrationHandler implementation="com.jetbrains.aspire.rider.orchestration.AzureFunctionOrchestrationHandler"/>
    </extensions>

    <actions>
        <action id="Aspire.AddToSolution"
                class="com.jetbrains.aspire.rider.actions.AddAspireToSolutionAction"
                icon="RiderIcons.Templates.TemplateAspire">
            <add-to-group group-id="SolutionViewAddGroup.SolutionSection" relative-to-action="NewRiderSolutionFolder"
                          anchor="after"/>
            <override-text place="GoToAction"/>
        </action>
        <action id="Aspire.AddToProject"
                class="com.jetbrains.aspire.rider.actions.AddAspireToProjectAction"
                icon="RiderIcons.Templates.TemplateAspire">
            <override-text place="GoToAction"/>
        </action>
        <action id="Aspire.Solution.Manifest"
                class="com.jetbrains.aspire.rider.actions.ManifestGenerationAction"
                icon="AllIcons.FileTypes.Json">
            <add-to-group group-id="SolutionExplorerPopupMenu.Tools"/>
        </action>
        <action id="Aspire.Host.Manifest"
                class="com.jetbrains.aspire.rider.actions.dashboard.host.AspireManifestAction"
                icon="AllIcons.FileTypes.Json">
            <add-to-group group-id="Aspire.Host" anchor="last"/>
            <add-to-group group-id="Aspire.Host.Tollbar" anchor="after" relative-to-action="Aspire.Host.Dashboard"/>
            <override-text place="GoToAction"/>
        </action>
        <action id="Aspire.Resource.Attach"
                class="com.jetbrains.aspire.rider.actions.dashboard.resource.AttachToProjectResourceAction"
                icon="AllIcons.Debugger.AttachToProcess">
            <add-to-group group-id="Aspire.Resource" relative-to-action="Aspire.Resource.RestartWithDebugger"
                          anchor="after"/>
            <override-text place="GoToAction"/>
        </action>
        <action id="Aspire.Resource.NavigateToDebugTab"
                class="com.jetbrains.aspire.rider.actions.dashboard.resource.NavigateToResourceDebugTab"
                icon="AllIcons.General.OpenInToolWindow">
            <add-to-group group-id="Aspire.Resource" relative-to-action="Aspire.Resource.RestartWithDebugger"
                          anchor="after"/>
            <override-text place="GoToAction"/>
        </action>
    </actions>

</idea-plugin>